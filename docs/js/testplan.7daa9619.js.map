{"version":3,"sources":["webpack:///./src/views/testplan/testplan.vue","webpack:///./src/api/runTestplan.js","webpack:///./src/views/testplan/testplan.vue?3258","webpack:///./src/api/locust.js","webpack:///./src/api/testplan.js","webpack:///./src/utils/request.js"],"names":["type","to","columns","data-source","data","scroll","bodyCell","record","column","text","dataIndex","id","key","runplan","showModal","overlay","deletes","toLocust","class","visible","title","handleOk","label","rules","value","cronData","cron","checked","runTestplan_post","request","method","url","taskTestplanPost","Deltask","width","ellipsis","setup","testplan","then","res","code","message","success","content","duration","location","reload","console","log","result","test_plan_id","task__cron","task__id","e","requstData","name","JSON","parse","localStorage","user","locust","error","msg","__exports__","render","locust_get","params","locust_detail","locust_put","locust_create","locustRun","locust_del","testplan_api","testplan_get","testplan_del","allURL","process","VUE_APP_FLAG","VUE_APP_BASEURL","axios","create","baseURL","timeout","defaults","headers","post","errorHandler","response","token","getItem","status","notification","description","window","href","isLogin","router","useRouter","push","Promise","reject","interceptors","use","config"],"mappings":"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","file":"js/testplan.7daa9619.js","sourcesContent":["\r\n<template>\r\n  <a-button type=\"primary\">\r\n    <router-link to=\"create_testplan\">Create </router-link>\r\n  </a-button>\r\n  <a-table :columns=\"columns\" :data-source=\"data\" :scroll=\"{ y: 800 }\">\r\n    <template #bodyCell=\"{ record, column, text }\">\r\n      <template v-if=\"column.dataIndex === 'name'\">\r\n        <router-link\r\n          :to=\"{ path: '/create_testplan', query: { id: record.id } }\"\r\n        >\r\n          <a>{{ text }}</a>\r\n        </router-link>\r\n      </template>\r\n\r\n      <template v-if=\"column.key === 'operation'\">\r\n        \r\n        <router-link\r\n          :to=\"{ path: '/create_testplan', query: { id: record.id } }\"\r\n        >\r\n          <a>Edit</a>\r\n        </router-link>\r\n        |\r\n        <router-link\r\n          :to=\"{ path: '/reportList', query: { testplan_id: record.id } }\"\r\n        >\r\n          <a>report</a>\r\n        </router-link>\r\n        |<a @click=\"runplan(record.id)\"> run</a> |\r\n        <a type=\"primary\" @click=\"showModal(record)\">添加定时任务</a>\r\n        <a-dropdown>\r\n          <a class=\"ant-dropdown-link\" @click.prevent>\r\n            更多\r\n            <DownOutlined />\r\n          </a>\r\n          <template #overlay>\r\n            <a-menu>\r\n              <a-menu-item>\r\n                <a @click=\"deletes(record)\">Delete</a> \r\n              </a-menu-item>\r\n              <a-menu-item>\r\n                <a @click=\"toLocust(record)\">转locust</a>\r\n              </a-menu-item>\r\n            </a-menu>\r\n          </template>\r\n        </a-dropdown>\r\n      </template>\r\n    </template>\r\n  </a-table>\r\n  <a-modal v-model:visible=\"visible\" title=\"添加定时任务\" @ok=\"handleOk\">\r\n    <a-form-item label=\"cron表达式\" :rules=\"[{ required: true }]\">\r\n      <a-input v-model:value=\"cronData.value.cron\" />\r\n      <a-radio v-model:checked=\"checked\">删除</a-radio>\r\n    </a-form-item>\r\n  </a-modal>\r\n</template>\r\n<script>\r\nimport { defineComponent, ref, reactive } from \"vue\";\r\nimport { testplan_get, testplan_del } from \"@/api/testplan\";\r\nimport { runTestplan_post, taskTestplanPost, Deltask } from \"@/api/runTestplan\";\r\nconst columns = [\r\n  {\r\n    title: \"Full Name\",\r\n    width: \"20%\",\r\n    dataIndex: \"name\",\r\n    key: \"name\",\r\n    ellipsis: true,\r\n  },\r\n  {\r\n    title: \"describe\",\r\n    width: \"20%\",\r\n    dataIndex: \"describe\",\r\n    key: \"describe\",\r\n    ellipsis: true,\r\n  },\r\n  {\r\n    title: \"project\",\r\n    dataIndex: \"project__name\",\r\n    key: \"project__name\",\r\n    width: \"20%\",\r\n    ellipsis: true,\r\n  },\r\n  {\r\n    title: \"createtime\",\r\n    dataIndex: \"create_time\",\r\n    key: \"create_time\",\r\n    width: \"20%\",\r\n    ellipsis: true,\r\n  },\r\n  {\r\n    title: \"Action\",\r\n    key: \"operation\",\r\n    width: 120,\r\n  },\r\n];\r\nimport { message } from \"ant-design-vue\";\r\nimport { locust_create } from \"../../api/locust\";\r\n\r\nexport default defineComponent({\r\n  setup() {\r\n    const data = ref();\r\n    testplan_get().then((res) => {\r\n      data.value = res.data;\r\n    });\r\n    const deletes = (record) => {\r\n      testplan_del(record.id).then((res) => {\r\n        if (res.code == 200) {\r\n          message.success({\r\n            content: \"删除成功！\",\r\n            duration: 5,\r\n          });\r\n          location.reload();\r\n        } else {\r\n          message.success({\r\n            content: \"删除失败！\",\r\n            duration: 5,\r\n          });\r\n        }\r\n\r\n        console.log(res);\r\n        console.log(res.data.data.result);\r\n      });\r\n    };\r\n    const runplan = (record) => {\r\n      message.success({\r\n        content: \"开始运行！\",\r\n        duration: 5,\r\n      });\r\n      runTestplan_post({ id: record }).then((res) => {\r\n        if (res.code == 200) {\r\n          message.success({\r\n            content: \"运行成功！\",\r\n            duration: 5,\r\n          });\r\n          //  location.reload();\r\n        } else {\r\n          message.success({\r\n            content: \"运行失败！\",\r\n            duration: 5,\r\n          });\r\n        }\r\n\r\n        console.log(res);\r\n        console.log(res.data.result);\r\n      });\r\n    };\r\n\r\n    const visible = ref(false);\r\n    const showModal = (record) => {\r\n      cronData.value = { test_plan_id: record.id, cron: record.task__cron };\r\n      if (record.task__id) {\r\n        cronData.value.id = record.task__id;\r\n      }\r\n      visible.value = true;\r\n    };\r\n    const handleOk = (e) => {\r\n      console.log(e, cronData);\r\n      if (checked.value == true) {\r\n        Deltask(cronData.value.id).then((res) => {\r\n          if (res.code == 200) {\r\n            message.success({\r\n              content: \"删除成功！\",\r\n              duration: 5,\r\n            });\r\n            testplan_get().then((res) => {\r\n              data.value = res.data;\r\n            });\r\n          } else {\r\n            message.success({\r\n              content: \"删除失败！\",\r\n              duration: 5,\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        taskTestplanPost(cronData.value).then((res) => {\r\n          if (res.code == 200) {\r\n            message.success({\r\n              content: \"添加成功！\",\r\n              duration: 5,\r\n            });\r\n            testplan_get().then((res) => {\r\n              data.value = res.data;\r\n            });\r\n          } else {\r\n            message.success({\r\n              content: \"添加失败！\",\r\n              duration: 5,\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      visible.value = false;\r\n    };\r\n    const cronData = reactive({});\r\n    const checked = ref(false);\r\n\r\n    const toLocust =(record)=>{\r\n    const  requstData ={\r\n                \"mold\": \"tofile\",\r\n                \"name\": record.name + \".py\",\r\n                \"testplan_id\": record.id,\r\n                \"create_user\":JSON.parse(localStorage.user).name\r\n            }\r\n\r\n      locust_create(requstData).then((res) => {\r\n          if (res.code == 200) {\r\n            message.success({\r\n              content: \"添加成功！\",\r\n              duration: 5,\r\n            });\r\n          } else {\r\n            message.error({\r\n              content: \"添加失败！\" +res.msg ,\r\n              duration: 5,\r\n            });\r\n          }\r\n        });\r\n\r\n    }\r\n    return {\r\n      deletes,\r\n      runplan,\r\n      visible,\r\n      showModal,\r\n      handleOk,\r\n      cronData,\r\n      checked,\r\n      data,\r\n      columns,\r\n      toLocust,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n","import request from '@/utils/request'\r\n\r\nexport function runTestplan_api(data,method){\r\n    return request.request({\r\n        method: method,\r\n          url: \"testplan/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function runTestplan_post(data){\r\n    return request.request({\r\n        method: \"post\",\r\n          url: \"runtestplan/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function taskTestplanPost(data){\r\n    return request.request({\r\n        method: \"post\",\r\n          url: \"task/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function taskDetails(id){\r\n    return request.request({\r\n        method: \"get\",\r\n          url: \"task/\" + id,\r\n    })\r\n}\r\n\r\nexport function Deltask(id){\r\n    return request.request({\r\n        method: \"delete\",\r\n          url: \"task/\" + id,\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\n","import { render } from \"./testplan.vue?vue&type=template&id=d135a150\"\nimport script from \"./testplan.vue?vue&type=script&lang=js\"\nexport * from \"./testplan.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\zjy\\\\GitHub\\\\vue_apitest\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import request from '@/utils/request'\r\n\r\nexport function locust_api(data,method){\r\n    return request.request({\r\n        method: method,\r\n          url: \"locust/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function locust_get(data){\r\n    return request.request({\r\n        method: \"get\",\r\n          url: \"locust/\",\r\n          params: data,\r\n    })\r\n}\r\nexport function locust_detail(id){\r\n    return request.request({\r\n        method: \"get\",\r\n          url: \"locust/\" + id,\r\n\r\n    })\r\n}\r\nexport function locust_put(data){\r\n    return request.request({\r\n        method: \"put\",\r\n          url: \"locust/\" + data.id +\"/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function locust_create(data){\r\n    return request.request({\r\n        method: \"post\",\r\n          url: \"locust/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function locustRun(data){\r\n    return request.request({\r\n        method: \"post\",\r\n          url: \"runLocust/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function locust_del(id){\r\n    return request.request({\r\n        method: \"delete\",\r\n          url: \"locust/\" + id +\"/\",\r\n    })\r\n}","import request from '@/utils/request'\r\n\r\nexport function testplan_api(data,method){\r\n    return request.request({\r\n        method: method,\r\n          url: \"testplan/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function testplan_get(data){\r\n    return request.request({\r\n        method: \"get\",\r\n          url: \"testplan/\",\r\n          params: data,\r\n    })\r\n}\r\n\r\nexport function testplan_put(data){\r\n    return request.request({\r\n        method: \"put\",\r\n          url: \"testplan/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function testplan_create(data){\r\n    return request.request({\r\n        method: \"post\",\r\n          url: \"testplan/\",\r\n          data: data,\r\n    })\r\n}\r\n\r\nexport function testplan_del(data){\r\n    return request.request({\r\n        method: \"delete\",\r\n          url: \"testplan/\",\r\n          data: [data],\r\n    })\r\n}","import axios from 'axios'\r\n// import store from '@/store'\r\n// import storage from 'store'\r\nimport notification from 'ant-design-vue/es/notification'\r\n// import { VueAxios } from './axios'\r\n// import { token } from '@/store/mutation-types'\r\nimport { useRouter } from 'vue-router';\r\n\r\nlet allURL;\r\nif (process.env.VUE_APP_FLAG == \"dev\") {\r\n  allURL = process.env.VUE_APP_BASEURL;\r\n} else{\r\n  allURL = \"https://www.zaojingyoutu.top:8000/api/\";\r\n}\r\n\r\n\r\n// 创建 axios 实例\r\nconst request = axios.create({\r\n  // API 请求的默认前缀\r\n  baseURL: allURL,\r\n  timeout: 300000 // 请求超时时间\r\n})\r\nrequest.defaults.headers.post['Content-Type'] = 'application/json;charset=UTF-8';//配置请求头信息。\r\n// 异常拦截处理器\r\nconst errorHandler = (error) => {\r\n  if (error.response) {\r\n    const data = error.response.data\r\n    // 从 localstorage 获取 token\r\n    const token = localStorage.getItem(\"token\")\r\n    if (error.response.status === 403) {\r\n      notification.error({\r\n        message: 'Forbidden',\r\n        description: data.message\r\n      })\r\n      window.location.href=\"#/login\";\r\n      // const router = useRouter();\r\n      // router.push(\"/login\")\r\n\r\n    }\r\n    if (error.response.status === 401 && !(data.result && data.result.isLogin)) {\r\n      notification.error({\r\n        message: 'Unauthorized',\r\n        description: 'Authorization verification failed'\r\n\r\n      })\r\n      if (token) {\r\n        // store.dispatch('Logout').then(() => {\r\n        //   setTimeout(() => {\r\n        //     window.location.reload()\r\n        //   }, 1500)\r\n        window.location.reload()\r\n        // })\r\n      }\r\n      // window.location.href=\"/login\";\r\n      const router = useRouter();\r\n      router.push(\"/login\")\r\n    }\r\n\r\n  }\r\n  return Promise.reject(error)\r\n}\r\n\r\n// request interceptor\r\nrequest.interceptors.request.use(config => {\r\n  const token = localStorage.getItem(\"token\")\r\n  // 如果 token 存在\r\n  // 让每个请求携带自定义 token 请根据实际情况自行修改\r\n  if (token) {\r\n    config.headers['Authorization'] = token\r\n  }\r\n  return config\r\n}, errorHandler)\r\n\r\n// response interceptor\r\nrequest.interceptors.response.use((response) => {\r\n  if(typeof response.data != 'string'){\r\n    response.data['status'] = response.status\r\n}\r\n  return response.data\r\n}, errorHandler)\r\n\r\n// const installer = {\r\n//   vm: {},\r\n//   install (Vue) {\r\n//     Vue.use(VueAxios, request)\r\n//   }\r\n// }\r\n\r\nexport default request\r\n\r\n// export {\r\n//   // installer as VueAxios,\r\n//   request as axios\r\n// }\r\n"],"sourceRoot":""}